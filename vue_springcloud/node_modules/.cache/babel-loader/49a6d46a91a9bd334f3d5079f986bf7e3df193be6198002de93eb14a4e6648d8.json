{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelText as _vModelText, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-9f407b9a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"wrapper\"\n};\nconst _hoisted_2 = {\n  class: \"form-box\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"您的余额：\", -1 /* HOISTED */));\nconst _hoisted_4 = {\n  class: \"content\"\n};\nconst _hoisted_5 = {\n  key: 0\n};\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"充值或提现：\", -1 /* HOISTED */));\nconst _hoisted_7 = {\n  class: \"content\"\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"title\"\n}, \"您的积分：\", -1 /* HOISTED */));\nconst _hoisted_9 = {\n  class: \"content\"\n};\nconst _hoisted_10 = {\n  class: \"button-login\"\n};\nconst _hoisted_11 = {\n  class: \"button-register\"\n};\nconst _hoisted_12 = {\n  class: \"button-register\"\n};\nconst _hoisted_13 = {\n  key: 0,\n  class: \"button-login\"\n};\nconst _hoisted_14 = {\n  key: 1,\n  class: \"button-register\"\n};\nconst _hoisted_15 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", null, \"您今天已签到\", -1 /* HOISTED */));\nconst _hoisted_16 = [_hoisted_15];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Footer = _resolveComponent(\"Footer\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" header部分 \"), _createElementVNode(\"header\", null, [_createElementVNode(\"p\", null, _toDisplayString(`${_ctx.user.userName} ${_ctx.user.userSex ? \"先生\" : \"女士\"}`), 1 /* TEXT */)]), _createCommentVNode(\" 表单部分 \"), _createElementVNode(\"ul\", _hoisted_2, [_createElementVNode(\"li\", null, [_hoisted_3, _createElementVNode(\"div\", _hoisted_4, [$data.balance != null ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, _toDisplayString($data.balance), 1 /* TEXT */)) : (_openBlock(), _createElementBlock(\"div\", {\n    key: 1,\n    class: \"createWallet\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.createWallet && $options.createWallet(...args))\n  }, \"创建钱包\"))])]), _createElementVNode(\"li\", null, [_hoisted_6, _createElementVNode(\"div\", _hoisted_7, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.money = $event),\n    placeholder: \"操作金额\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.money]])])]), _createElementVNode(\"li\", null, [_hoisted_8, _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"p\", null, _toDisplayString($data.creditNum), 1 /* TEXT */)])])]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.recharge && $options.recharge(...args))\n  }, _toDisplayString($data.creditEarningByRecharge == 0 ? \"充值\" : \"充值您可获得\" + $data.creditEarningByRecharge + \"积分\"), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.withdrawMoney && $options.withdrawMoney(...args))\n  }, \"提现\")]), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.router2tans && $options.router2tans(...args))\n  }, \"积分明细\")]), $data.creditEarningBySign != 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [_createElementVNode(\"button\", {\n    onClick: _cache[5] || (_cache[5] = $event => $options.sign(_ctx.user.userId, $data.creditEarningBySign))\n  }, \" 今天签到可以拿\" + _toDisplayString($data.creditEarningBySign) + \"积分 \", 1 /* TEXT */)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, _hoisted_16)), _createCommentVNode(\" 底部菜单部分 \"), _createVNode(_component_Footer)]);\n}","map":{"version":3,"names":["class","_createElementVNode","_hoisted_15","_createElementBlock","_hoisted_1","_createCommentVNode","_toDisplayString","_ctx","user","userName","userSex","_hoisted_2","_hoisted_3","_hoisted_4","$data","balance","_hoisted_5","onClick","_cache","args","$options","createWallet","_hoisted_6","_hoisted_7","money","$event","placeholder","_hoisted_8","_hoisted_9","creditNum","_hoisted_10","recharge","creditEarningByRecharge","_hoisted_11","withdrawMoney","_hoisted_12","router2tans","creditEarningBySign","_hoisted_13","sign","userId","_hoisted_14","_hoisted_16","_createVNode","_component_Footer"],"sources":["C:\\WAILE\\Homework\\elm\\vue_springcloud\\src\\views\\Wallet.vue"],"sourcesContent":["<template>\r\n  <div class=\"wrapper\">\r\n    <!-- header部分 -->\r\n    <header>\r\n      <p>{{ `${user.userName} ${user.userSex ? \"先生\" : \"女士\"}` }}</p>\r\n    </header>\r\n    <!-- 表单部分 -->\r\n    <ul class=\"form-box\">\r\n      <li>\r\n        <div class=\"title\">您的余额：</div>\r\n        <div class=\"content\">\r\n          <p v-if=\"balance != null\">{{ balance }}</p>\r\n          <div v-else class=\"createWallet\" @click=\"createWallet\">创建钱包</div>\r\n        </div>\r\n      </li>\r\n      <li>\r\n        <div class=\"title\">充值或提现：</div>\r\n        <div class=\"content\">\r\n          <input v-model=\"money\" placeholder=\"操作金额\" />\r\n        </div>\r\n      </li>\r\n      <li>\r\n        <div class=\"title\">您的积分：</div>\r\n        <div class=\"content\">\r\n          <p>{{ creditNum }}</p>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n    <div class=\"button-login\">\r\n      <button @click=\"recharge\">\r\n        {{\r\n          creditEarningByRecharge == 0\r\n            ? \"充值\"\r\n            : \"充值您可获得\" + creditEarningByRecharge + \"积分\"\r\n        }}\r\n      </button>\r\n    </div>\r\n\r\n    <div class=\"button-register\">\r\n      <button @click=\"withdrawMoney\">提现</button>\r\n    </div>\r\n    <div class=\"button-register\">\r\n      <button @click=\"router2tans\">积分明细</button>\r\n    </div>\r\n    <div class=\"button-login\" v-if=\"creditEarningBySign != 0\">\r\n      <button @click=\"sign(user.userId, creditEarningBySign)\">\r\n        今天签到可以拿{{ creditEarningBySign }}积分\r\n      </button>\r\n    </div>\r\n    <div class=\"button-register\" v-else>\r\n      <button>您今天已签到</button>\r\n    </div>\r\n\r\n    <!-- 底部菜单部分 -->\r\n    <Footer></Footer>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Footer from \"../components/Footer.vue\";\r\n\r\nexport default {\r\n  name: \"Me\",\r\n  data() {\r\n    return {\r\n      creditNum: 0,\r\n      creditEarningBySign: 0,\r\n      creditEarningByRecharge: 0,\r\n      balance: 0,\r\n      userId: \"\",\r\n      money: \"\",\r\n      reg: /^(([1-9][0-9]*)|(([0]\\.\\d{1,2}|[1-9][0-9]*\\.\\d{1,2})))$/,\r\n    };\r\n  },\r\n  watch: {\r\n    money: function (val) {\r\n      // this.queryEarnCreditByRecharge(this.user.userId,this.money);\r\n      if (this.reg.test(val)) {\r\n        this.queryEarnCreditByRecharge(this.user.userId, val);\r\n      }\r\n      if (val == \"\") {\r\n        this.creditEarningByRecharge = 0;\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.user = this.$getSessionStorage(\"user\");\r\n    this.queryBalance();\r\n    this.queryAvailableCredit(this.user.userId);\r\n    this.queryEarningCreditBySign(this.user.userId);\r\n  },\r\n  methods: {\r\n    queryBalance() {\r\n      //查询余额\r\n      // console.log(\"查询余额\",this.user);\r\n      if (this.user.walletId == null) {\r\n        this.balance = null;\r\n      } else {\r\n        let url = \"VirtualWalletController/queryBalance/\" + this.user.walletId;\r\n        this.$axios\r\n          .get(url)\r\n          .then((response) => {\r\n            this.balance = response.data.result;\r\n          })\r\n          .catch((error) => {\r\n            console.error(error);\r\n          });\r\n      }\r\n    },\r\n    queryAvailableCredit(userId) {\r\n      //查询可用积分\r\n      let url = \"CreditController/queryAvailableCredit/\" + userId;\r\n      this.$axios\r\n        .get(url)\r\n        .then((response) => {\r\n          this.creditNum = response.data.result;\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        });\r\n    },\r\n    queryEarningCreditBySign(userId) {\r\n      //查询签到积分\r\n      let url = \"CreditController/queryEarningCreditBySign/\" + userId;\r\n      this.$axios\r\n        .get(url)\r\n        .then((response) => {\r\n          this.creditEarningBySign = response.data.result;\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        });\r\n    },\r\n    queryEarnCreditByRecharge(userId, money) {\r\n      //查询充值所获积分\r\n      money = Math.floor(money);\r\n      let url =\r\n        \"CreditController/queryEarnCreditByRecharge/\" + userId + \"/\" + money;\r\n      this.$axios\r\n        .get(url)\r\n        .then((response) => {\r\n          this.creditEarningByRecharge = Math.floor(response.data.result);\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        });\r\n    },\r\n    sign(userId, creditNum) {\r\n      //签到后更新积分\r\n      let url = \"CreditController/earnCreditBySign/\" + userId + \"/\" + creditNum;\r\n      this.$axios\r\n        .put(url)\r\n        .then((response) => {\r\n          if (response.data.result == 1) {\r\n            this.queryEarningCreditBySign(userId);\r\n            this.queryAvailableCredit(userId);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        });\r\n    },\r\n    createWallet() {\r\n      //创建钱包\r\n      let url_1 =\r\n        \"VirtualWalletController/userCreateVirtualWallet/\" + this.user.userId;\r\n      this.$axios\r\n        .post(url_1)\r\n        .then((response) => {\r\n          this.user.walletId = response.data.result;\r\n          this.$setSessionStorage(\"user\", this.user);\r\n          // 钱包创建成功，更新余额\r\n          // console.log(\"after create wallet\")\r\n          // console.log(\"创建钱包\",this.user)\r\n          let url_2 =\r\n            \"VirtualWalletController/queryBalance/\" + this.user.walletId;\r\n          this.$axios\r\n            .get(url_2)\r\n            .then((response) => {\r\n              this.balance = response.data.result;\r\n            })\r\n            .catch((error) => {\r\n              console.error(error);\r\n            });\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        });\r\n    },\r\n    router2tans() {\r\n      //查看流水\r\n      if (this.user.walletId == null || this.balance == null) {\r\n        alert(\"您未开通虚拟钱包!请开通!\");\r\n      } else {\r\n        this.$router.push({ path: \"/transaction\" });\r\n      }\r\n    },\r\n    recharge() {\r\n      //充值\r\n      if (!this.reg.test(this.money)) {\r\n        alert(\"充值金额错误!\");\r\n      } else if (this.user.walletId == null || this.balance == null) {\r\n        alert(\"您未开通虚拟钱包!请开通!\");\r\n      } else {\r\n        if (this.creditEarningByRecharge == 0) {\r\n          let url_1 =\r\n            \"VirtualWalletController/recharge/\" +\r\n            this.user.walletId +\r\n            \"/\" +\r\n            this.money;\r\n          this.$axios\r\n            .put(url_1)\r\n            .then((response) => {\r\n              if (response.data.result == 1) {\r\n                alert(\"充值成功\");\r\n                this.queryBalance();\r\n              } else {\r\n                alert(\"充值失败\");\r\n              }\r\n              this.money = 0;\r\n            })\r\n            .catch((error) => {\r\n              console.error(error);\r\n            });\r\n        } else {\r\n          let url_2 =\r\n            \"CreditController/earnCreditBySignAndRecharge/\" +\r\n            this.user.userId +\r\n            \"/\" +\r\n            this.user.walletId +\r\n            \"/\" +\r\n            Math.floor(this.money) +\r\n            \"/\" +\r\n            this.creditEarningByRecharge;\r\n          this.$axios\r\n            .put(url_2)\r\n            .then((response) => {\r\n              if (response.data.result == 1) {\r\n                alert(\"充值成功\");\r\n                this.queryBalance();\r\n                this.queryAvailableCredit(this.user.userId);\r\n              } else {\r\n                alert(\"充值失败\");\r\n              }\r\n              this.money = 0;\r\n            })\r\n            .catch((error) => {\r\n              alert(\"充值失败,最大余额十万\");\r\n              console.error(error);\r\n            });\r\n        }\r\n      }\r\n    },\r\n    withdrawMoney() {\r\n      //提现\r\n      if (!this.reg.test(this.money)) {\r\n        alert(\"提现金额错误!\");\r\n      } else if (this.user.walletId == null || this.balance == null) {\r\n        alert(\"您未开通虚拟钱包!请开通!\");\r\n      } else if (this.money > this.balance) {\r\n        alert(\"余额不足\");\r\n      } else {\r\n        let url =\r\n          \"VirtualWalletController/withdrawMoney/\" +\r\n          this.user.walletId +\r\n          \"/\" +\r\n          this.money;\r\n        this.$axios\r\n          .put(url)\r\n          .then((response) => {\r\n            if (response.data.result == 1) {\r\n              alert(\"提现成功\");\r\n              this.queryBalance();\r\n            } else {\r\n              alert(\"提现失败\");\r\n            }\r\n            this.money = 0;\r\n          })\r\n          .catch((error) => {\r\n            console.error(error);\r\n          });\r\n      }\r\n    },\r\n  },\r\n  components: {\r\n    Footer,\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n/****************** 总容器 ******************/\r\n.wrapper {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n/****************** header部分 ******************/\r\n.wrapper header {\r\n  width: 100%;\r\n  height: 12vw;\r\n  background-color: deepskyblue;\r\n  color: #fff;\r\n  font-size: 4.8vw;\r\n  position: fixed;\r\n  left: 0;\r\n  top: 0;\r\n  z-index: 1000;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n/****************** 表单部分 ******************/\r\n.wrapper .form-box {\r\n  width: 100%;\r\n  margin-top: 12vw;\r\n}\r\n\r\n.wrapper .form-box li {\r\n  box-sizing: border-box;\r\n  padding: 4vw 3vw 0 3vw;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.wrapper .form-box li .title {\r\n  flex: 0 0 25vw;\r\n  font-size: 3vw;\r\n  font-weight: 700;\r\n  color: #666;\r\n}\r\n\r\n.wrapper .form-box li .content {\r\n  flex: 1;\r\n  font-size: 3vw;\r\n}\r\n\r\n.wrapper .form-box li .content input {\r\n  border: none;\r\n  outline: none;\r\n  width: 100%;\r\n  height: 4vw;\r\n  font-size: 3vw;\r\n}\r\n\r\n.wrapper .form-box li .content .createWallet {\r\n  width: 26%;\r\n  background-color: #f90;\r\n  color: #fff;\r\n  border-radius: 4vw;\r\n  margin-left: 2vw;\r\n  user-select: none;\r\n  cursor: pointer;\r\n}\r\n\r\n.wrapper .button-login {\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  padding: 4vw 3vw 0 3vw;\r\n}\r\n\r\n.wrapper .button-login button {\r\n  width: 100%;\r\n  height: 10vw;\r\n  font-size: 3.8vw;\r\n  font-weight: 700;\r\n  color: #fff;\r\n  background-color: #38ca73;\r\n  border-radius: 4vw;\r\n  border: none;\r\n  outline: none;\r\n  cursor: pointer;\r\n}\r\n\r\n.wrapper .button-register {\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  padding: 4vw 3vw 0 3vw;\r\n}\r\n\r\n.wrapper .button-register button {\r\n  width: 100%;\r\n  height: 10vw;\r\n  font-size: 3.8vw;\r\n  font-weight: 700;\r\n  /*与上面登陆按钮不同的只有颜色、背景色、边框不同*/\r\n  color: #666;\r\n  background-color: white;\r\n  border: solid 1px #ddd;\r\n  border-radius: 4vw;\r\n  border: none;\r\n  outline: none;\r\n  cursor: pointer;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}